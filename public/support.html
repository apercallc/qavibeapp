<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Get Support - QAVibe</title>
    <meta name="description" content="Get technical support for QAVibe's testing tools. Our team is here to help with TestFlux and StackHealth implementation.">
    <meta name="config:recaptcha_site_key" content="your-site-key-here">
    <link rel="icon" type="image/x-icon" href="./favicon.ico">
    <link rel="stylesheet" href="./styles.css">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800;900&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css">
    <script src="./config.js" defer></script>
    <script src="./components/nav.js" defer></script>
    <script src="./components/footer.js" defer></script>
    <script src="./script.js" defer></script>
    <script src="https://www.google.com/recaptcha/api.js?onload=onRecaptchaLoad&render=explicit" async defer></script>
</head>

<body>
    <!-- Navigation will be inserted by nav.js -->

    <!-- Hero Section -->
    <!-- Hero Section -->
    <section class="hero" style="padding: 6rem 0 4rem 0;">
        <div class="hero-container">
            <div class="hero-content" style="text-align: center;">
                <h1>Get Support</h1>
                <p class="hero-description">
                    Need help with our testing tools? Our team is here to assist you with technical support and guidance.
                </p>
            </div>
        </div>
    </section>

    <!-- Support Form Section -->
    <section class="support-form-section" style="padding: 4rem 0 6rem 0;">
        <div class="container">
            <div class="support-form-container">
                <div class="form-header">
                    <h2>Submit a Support Request</h2>
                    <p>Fill out the form below and our team will get back to you within 24 hours.</p>
                </div>
                
                <form id="supportForm" class="support-form">
                    <div class="form-row">
                        <div class="form-group">
                            <label for="firstName">First Name *</label>
                            <input type="text" id="firstName" name="firstName" required>
                        </div>
                        <div class="form-group">
                            <label for="lastName">Last Name *</label>
                            <input type="text" id="lastName" name="lastName" required>
                        </div>
                    </div>
                    
                    <div class="form-row">
                        <div class="form-group">
                            <label for="email">Email Address *</label>
                            <input type="email" id="email" name="email" required>
                        </div>
                        <div class="form-group">
                            <label for="company">Company</label>
                            <input type="text" id="company" name="company">
                        </div>
                    </div>
                    
                    <div class="form-group">
                        <label for="product">Which product do you need help with? *</label>
                        <select id="product" name="product" required>
                            <option value="">Select a product...</option>
                            <option value="testflux">TestFlux - Test Results Dashboard</option>
                            <option value="stackhealth">StackHealth - Scorecard Platform</option>
                            <option value="both">Both Products</option>
                            <option value="general">General Question</option>
                        </select>
                    </div>
                    
                    <div class="form-group">
                        <label for="priority">Priority Level *</label>
                        <select id="priority" name="priority" required>
                            <option value="">Select priority...</option>
                            <option value="low">Low - General question</option>
                            <option value="medium">Medium - Feature request</option>
                            <option value="high">High - Bug or issue</option>
                            <option value="urgent">Urgent - Critical problem</option>
                        </select>
                    </div>
                    
                    <div class="form-group">
                        <label for="subject">Subject *</label>
                        <input type="text" id="subject" name="subject" placeholder="Brief description of your issue" required>
                    </div>
                    
                    <div class="form-group">
                        <label for="message">Detailed Description *</label>
                        <textarea id="message" name="message" rows="6" placeholder="Please provide detailed information about your issue, including steps to reproduce, error messages, and expected behavior..." required></textarea>
                    </div>
                    
                    <div class="form-group">
                        <label for="environment">Environment Information</label>
                        <textarea id="environment" name="environment" rows="3" placeholder="Operating system, browser version, tool versions, etc. (optional)"></textarea>
                    </div>
                    
                    <div class="form-group captcha-container">
                        <div class="g-recaptcha" data-sitekey="" id="support-recaptcha"></div>
                    </div>
                    
                    <button type="submit" class="submit-btn" id="submitBtn">
                        <i class="fas fa-paper-plane"></i>
                        Submit Support Request
                    </button>
                    
                    <div id="formMessage" class="form-message" style="display: none;"></div>
                </form>
            </div>
        </div>
    </section>

    <!-- Footer -->
    <footer class="footer">
        <div class="footer-container">
            <div class="footer-content">
                <div class="footer-section">
                    <h4>QAVibe</h4>
                    <p>Free enterprise-grade testing tools for modern teams.</p>
                    <div class="social-links">
                        <a href="https://thoangdev.github.io/" target="_blank" rel="noopener noreferrer">
                            <i class="fab fa-github"></i>
                        </a>
                        <a href="https://www.linkedin.com/in/tommyqhoang/" target="_blank" rel="noopener noreferrer">
                            <i class="fab fa-linkedin"></i>
                        </a>
                    </div>
                </div>
                <div class="footer-section">
                    <h4>Products</h4>
                    <ul>
                        <li><a href="https://testflux.qavibeapp.com" target="_blank">TestFlux</a></li>
                        <li><a href="https://stackhealth.qavibeapp.com" target="_blank">StackHealth</a></li>
                    </ul>
                </div>
                <div class="footer-section">
                    <h4>Legal</h4>
                    <ul>
                        <li><a href="./privacy-policy.html">Privacy Policy</a></li>
                        <li><a href="./terms-of-service.html">Terms of Service</a></li>
                        <li><a href="./acceptable-use.html">Acceptable Use</a></li>
                        <li><a href="./legal-center.html">Legal Center</a></li>
                    </ul>
                </div>
                <div class="footer-section">
                    <h4>Support the Project</h4>
                    <p>Help us keep these tools free for everyone.</p>
                    <button class="donate-btn" onclick="window.open('https://paypal.me/tommyqhoang/', '_blank')">
                        <i class="fas fa-heart"></i>
                        Donate
                    </button>
                </div>
            </div>
            <div class="footer-bottom">
                <p>&copy; 2025 QAVibe. All rights reserved.</p>
                <p>Made with ❤️ for the testing community</p>
            </div>
        </div>
    </footer>

    <script src="./script.js"></script>
    <script>
        // Support form handling
        document.getElementById('supportForm').addEventListener('submit', async function(e) {
            e.preventDefault();
            
            const submitBtn = document.getElementById('submitBtn');
            const formMessage = document.getElementById('formMessage');
            
            // Check reCAPTCHA
            const recaptchaResponse = typeof grecaptcha !== 'undefined' ? grecaptcha.getResponse() : null;
            if (!recaptchaResponse) {
                showMessage('Please complete the CAPTCHA verification.', 'error');
                return;
            }
            
            // Show loading state
            submitBtn.innerHTML = '<i class="fas fa-spinner fa-spin"></i> Submitting...';
            submitBtn.disabled = true;
            
            try {
                const formData = new FormData(this);
                formData.append('recaptcha', recaptchaResponse);
                
                const apiBaseUrl = window.location.hostname === 'localhost' ? 'http://localhost:3002' : '';
                const response = await fetch(`${apiBaseUrl}/api/support-request`, {
                    method: 'POST',
                    body: formData
                });
                
                const result = await response.json();
                
                if (response.ok) {
                    showMessage('Support request submitted successfully! We\'ll get back to you within 24 hours.', 'success');
                    this.reset();
                    if (typeof grecaptcha !== 'undefined') {
                        grecaptcha.reset();
                    }
                } else {
                    showMessage(result.error || 'Failed to submit support request. Please try again.', 'error');
                }
            } catch (error) {
                console.error('Error:', error);
                showMessage('Network error. Please check your connection and try again.', 'error');
            } finally {
                submitBtn.innerHTML = '<i class="fas fa-paper-plane"></i> Submit Support Request';
                submitBtn.disabled = false;
            }
        });
        
        function showMessage(message, type) {
            const formMessage = document.getElementById('formMessage');
            formMessage.textContent = message;
            formMessage.className = `form-message ${type}`;
            formMessage.style.display = 'block';
            
            // Auto-hide success messages after 5 seconds
            if (type === 'success') {
                setTimeout(() => {
                    formMessage.style.display = 'none';
                }, 5000);
            }
        }
        
        // Initialize reCAPTCHA when the page loads
        window.addEventListener('DOMContentLoaded', function() {
            const siteKey = document.querySelector('meta[name="config:recaptcha_site_key"]')?.content || 'your-site-key-here';
            
            // Update reCAPTCHA elements with the correct site key
            const recaptchaElement = document.getElementById('support-recaptcha');
            if (recaptchaElement) {
                recaptchaElement.setAttribute('data-sitekey', siteKey);
            }
        });
        
        // Callback for when reCAPTCHA API is loaded
        window.onRecaptchaLoad = function() {
            const siteKey = document.querySelector('meta[name="config:recaptcha_site_key"]')?.content || 'your-site-key-here';
            
            const recaptchaElement = document.getElementById('support-recaptcha');
            if (recaptchaElement && !recaptchaElement.hasAttribute('data-rendered')) {
                try {
                    grecaptcha.render('support-recaptcha', {
                        'sitekey': siteKey
                    });
                    recaptchaElement.setAttribute('data-rendered', 'true');
                } catch (error) {
                    console.warn('reCAPTCHA render failed:', error);
                }
            }
        };
    </script>
</body>
</html>

    <script src="./script.js"></script>
    <script>
        // Support form handling
        document.getElementById('supportForm').addEventListener('submit', async function(e) {
            e.preventDefault();
            
            const submitBtn = document.getElementById('submitBtn');
            const formMessage = document.getElementById('formMessage');
            
            // Check reCAPTCHA
            const recaptchaResponse = typeof grecaptcha !== 'undefined' ? grecaptcha.getResponse() : null;
            if (!recaptchaResponse) {
                showMessage('Please complete the CAPTCHA verification.', 'error');
                return;
            }
            
            // Show loading state
            submitBtn.innerHTML = '<i class="fas fa-spinner fa-spin"></i> Submitting...';
            submitBtn.disabled = true;
            
            try {
                const formData = new FormData(this);
                formData.append('recaptcha', recaptchaResponse);
                
                const apiBaseUrl = window.location.hostname === 'localhost' ? 'http://localhost:3002' : '';
                const response = await fetch(`${apiBaseUrl}/api/support-request`, {
                    method: 'POST',
                    body: formData
                });
                
                const result = await response.json();
                
                if (response.ok) {
                    showMessage('Support request submitted successfully! We\'ll get back to you within 24 hours.', 'success');
                    this.reset();
                    if (typeof grecaptcha !== 'undefined') {
                        grecaptcha.reset();
                    }
                } else {
                    showMessage(result.error || 'Failed to submit support request. Please try again.', 'error');
                }
            } catch (error) {
                console.error('Error:', error);
                showMessage('Network error. Please check your connection and try again.', 'error');
            } finally {
                submitBtn.innerHTML = '<i class="fas fa-paper-plane"></i> Submit Support Request';
                submitBtn.disabled = false;
            }
        });
        
        function showMessage(message, type) {
            const formMessage = document.getElementById('formMessage');
            formMessage.textContent = message;
            formMessage.className = `form-message ${type}`;
            formMessage.style.display = 'block';
            
            // Auto-hide success messages after 5 seconds
            if (type === 'success') {
                setTimeout(() => {
                    formMessage.style.display = 'none';
                }, 5000);
            }
        }
        
        // Initialize reCAPTCHA when the page loads
        window.addEventListener('DOMContentLoaded', function() {
            const siteKey = document.querySelector('meta[name="config:recaptcha_site_key"]')?.content || 'your-site-key-here';
            
            // Update reCAPTCHA elements with the correct site key
            const recaptchaElement = document.getElementById('support-recaptcha');
            if (recaptchaElement) {
                recaptchaElement.setAttribute('data-sitekey', siteKey);
            }
        });
        
        // Callback for when reCAPTCHA API is loaded
        window.onRecaptchaLoad = function() {
            const siteKey = document.querySelector('meta[name="config:recaptcha_site_key"]')?.content || 'your-site-key-here';
            
            const recaptchaElement = document.getElementById('support-recaptcha');
            if (recaptchaElement && !recaptchaElement.hasAttribute('data-rendered')) {
                try {
                    grecaptcha.render('support-recaptcha', {
                        'sitekey': siteKey
                    });
                    recaptchaElement.setAttribute('data-rendered', 'true');
                } catch (error) {
                    console.warn('reCAPTCHA render failed:', error);
                }
            }
        };
    </script>
</body>
</html>

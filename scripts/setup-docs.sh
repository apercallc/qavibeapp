#!/bin/bash

echo "ğŸš€ Setting up QAVibe Documentation Automation"
echo "=============================================="

echo ""
echo "ğŸ“‹ Required GitHub Repository Setup:"
echo ""
echo "1. ğŸ” Create a Personal Access Token (PAT) with these permissions:"
echo "   - repo (full control of private repositories)"
echo "   - workflow (update GitHub Action workflows)"
echo ""
echo "2. ğŸ”§ Add the PAT as a repository secret:"
echo "   - Go to: Settings > Secrets and variables > Actions"
echo "   - Name: PRIVATE_REPO_TOKEN"
echo "   - Value: Your PAT from step 1"
echo ""
echo "3. ğŸ“„ Enable GitHub Pages:"
echo "   - Go to: Settings > Pages"
echo "   - Source: Deploy from a branch"
echo "   - Branch: main / (root)"
echo ""
echo "4. ğŸ”— Optional: Set up webhooks for real-time updates"
echo "   In your private repos (testflux & stackhealth):"
echo "   - Go to: Settings > Webhooks > Add webhook"
echo "   - Payload URL: https://api.github.com/repos/apercallc/qavibeapp/dispatches"
echo "   - Content type: application/json"
echo "   - Secret: (create a webhook secret and add as WEBHOOK_SECRET repository secret)"
echo "   - Events: Push events to main branch"
echo ""
echo "5. ğŸ“ Directory Structure Created:"
echo "   â”œâ”€â”€ .github/workflows/sync-docs.yml    (Auto-sync workflow)"
echo "   â”œâ”€â”€ scripts/generate-changelog.js      (Changelog processor)"
echo "   â”œâ”€â”€ docs/products/                     (Synced documentation)"
echo "   â”‚   â”œâ”€â”€ testflux/                      (TestFlux docs)"
echo "   â”‚   â””â”€â”€ stackhealth/                   (StackHealth docs)"
echo "   â””â”€â”€ public/docs/                       (Public documentation site)"
echo ""
echo "ğŸ¯ Next Steps:"
echo ""
echo "1. Complete the GitHub setup steps above"
echo "2. Run the workflow manually to test: Actions > Sync Documentation > Run workflow"
echo "3. Check the generated documentation at: https://apercallc.github.io/qavibeapp/docs/"
echo "4. The workflow will run every 6 hours automatically"
echo ""
echo "ğŸ“ Workflow Features:"
echo "â€¢ âœ… Pulls docs/ folder from both private repos"
echo "â€¢ âœ… Combines changelogs with date sorting"
echo "â€¢ âœ… Creates filterable changelog page"
echo "â€¢ âœ… Maintains private code security"
echo "â€¢ âœ… Auto-updates every 6 hours"
echo "â€¢ âœ… Manual trigger available"
echo "â€¢ âœ… Webhook support for real-time updates"
echo ""
echo "ğŸ”§ Customization:"
echo "â€¢ Edit scripts/generate-changelog.js to modify changelog format"
echo "â€¢ Edit public/docs/index.html to customize documentation layout"
echo "â€¢ Modify .github/workflows/sync-docs.yml to change sync frequency"
echo ""
echo "âœ¨ Setup complete! Check the GitHub repository for next steps."
